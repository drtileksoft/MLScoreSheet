<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:controls="clr-namespace:MLScoreSheetCounter.Controls"
             x:Class="MLScoreSheetCounter.MainPage">

    <Grid Padding="16" RowSpacing="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <VerticalStackLayout Grid.Row="0" Spacing="8">
            <Button x:Name="PickPhotoButton" Text="Vybrat fotku z galerie" Clicked="OnPickPhoto" />
            <Button x:Name="TakePhotoButton" Text="Vyfotit" Clicked="OnTakePhoto" />
        </VerticalStackLayout>

        <HorizontalStackLayout Grid.Row="1" Spacing="8" VerticalOptions="Center">
            <CheckBox x:Name="OverlayCheckBox" IsChecked="True" />
            <Label Text="Zobrazit zvýraznění" VerticalTextAlignment="Center" />
        </HorizontalStackLayout>

        <HorizontalStackLayout Grid.Row="2" Spacing="8" VerticalOptions="Center">
            <Label Text="Práh výpočtu" VerticalTextAlignment="Center" />
            <Slider x:Name="CalculationTresholdSlider"
                    Minimum="0"
                    Maximum="1"
                    Value="0.3"
                    HorizontalOptions="FillAndExpand"
                    ValueChanged="OnCalculationThresholdChanged" />
            <Label x:Name="CalculationThresholdValueLabel"
                   Text="0.30"
                   WidthRequest="50"
                   HorizontalTextAlignment="End"
                   VerticalTextAlignment="Center" />
        </HorizontalStackLayout>

        <HorizontalStackLayout Grid.Row="3" Spacing="8" VerticalOptions="Center">
            <Label Text="Práh viditelnosti" VerticalTextAlignment="Center" />
            <Slider x:Name="VisibilityTresholdSlider"
                    Minimum="0"
                    Maximum="1"
                    Value="0.3"
                    HorizontalOptions="FillAndExpand"
                    ValueChanged="OnVisibilityThresholdChanged" />
            <Label x:Name="VisibilityThresholdValueLabel"
                   Text="0.30"
                   WidthRequest="50"
                   HorizontalTextAlignment="End"
                   VerticalTextAlignment="Center" />
        </HorizontalStackLayout>

        <Label x:Name="ResultLabel"
               Grid.Row="4"
               Text="TOTAL = ?"
               FontSize="18"
               FontAttributes="Bold" />

        <HorizontalStackLayout x:Name="ProcessingContainer"
                                Grid.Row="5"
                                IsVisible="False"
                                Spacing="8"
                                VerticalOptions="Center">
            <ActivityIndicator x:Name="ProcessingIndicator" IsRunning="False" VerticalOptions="Center" />
            <Label x:Name="ProcessingLabel" Text="Probíhá zpracování..." VerticalTextAlignment="Center" />
        </HorizontalStackLayout>

        <controls:PinchToZoomContainer x:Name="PreviewContainer"
                                       Grid.Row="6"
                                       BackgroundColor="#111"
                                       VerticalOptions="Fill"
                                       HorizontalOptions="Fill">
            <Image x:Name="Preview"
                   Aspect="AspectFit"
                   VerticalOptions="Center"
                   HorizontalOptions="Center" />
        </controls:PinchToZoomContainer>

        <Button x:Name="SaveToGalleryButton"
                Grid.Row="7"
                Text="Uložit do galerie"
                IsEnabled="False"
                Clicked="OnSaveToGalleryClicked" />
    </Grid>
</ContentPage>
